<beans xmlns="http://www.springframework.org/schema/beans" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:security="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util" xmlns:p="http://www.springframework.org/schema/p"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans     
        http://www.springframework.org/schema/beans/spring-beans-4.2.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-4.2.xsd
        http://www.springframework.org/schema/security
        http://www.springframework.org/schema/security/spring-security-4.2.xsd
        http://www.springframework.org/schema/util
        http://www.springframework.org/schema/util/spring-util.xsd">

    <security:http auto-config="true" use-expressions="false" realm="Gallery">
        <security:cors configuration-source-ref="corsSource"/>
        <security:http-basic />
        <security:intercept-url pattern="/**" access="ROLE_USER" />
        <security:headers>
            <security:cache-control disabled="true" />
        </security:headers>
    </security:http>

    <security:authentication-manager>
        <security:authentication-provider>
            <security:user-service properties="${gallery.users.propertiesFile}">
            </security:user-service>
        </security:authentication-provider>
    </security:authentication-manager>

    <bean id="corsSource" class="org.springframework.web.cors.UrlBasedCorsConfigurationSource">
        <property name="corsConfigurations">
            <util:map>
                <entry key="/**">
                    <bean class="org.springframework.web.cors.CorsConfiguration">
                        <property name="allowCredentials" value="true" />
                        <property name="allowedHeaders">
                            <list>
                                <value>*</value>
                            </list>
                        </property>
                        <property name="allowedMethods">
                            <list>
								<value>*</value>
                            </list>
                        </property>
                        <property name="allowedOrigins" value="${gallery.web.allowedOrigins}" />
                        <property name="maxAge" value="86400" />
                    </bean>
                </entry>
            </util:map>
        </property>
    </bean>

</beans>